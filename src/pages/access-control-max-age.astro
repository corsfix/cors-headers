---
import Layout from "../layouts/Layout.astro";
import Article, { type HeaderData } from "../components/Article.astro";

const headerData: HeaderData = {
  name: "Access-Control-Max-Age",
  slug: "access-control-max-age",
  description:
    "The `Access-Control-Max-Age` header tells browsers how long they can cache the results of a CORS preflight request. The header is part of the preflight request response and controls how long the browser can cache the preflight result (the information about which methods and headers are allowed for a specific resource). Caching the preflight response is crucial for performance, as it reduces the number of preflight requests that need to be made. Normally, every CORS request would require a preflight, but with this header, subsequent identical CORS requests can skip the preflight check for the duration specified, thereby reducing latency.",
  syntax: {
    code: `Access-Control-Max-Age: <seconds>`,
    description: "The Access-Control-Max-Age header accepts a numeric value representing the number of seconds (e.g., `86400` for one day) that the preflight response can be cached by the browser. This reduces the number of preflight requests for subsequent identical CORS requests during the specified time period.",
  },
  examples: [
    {
      title: "Caching preflight for 1 hour",
      description: "The browser can cache the preflight response for 3600 seconds (1 hour), reducing the number of preflight requests.",
      code: `Access-Control-Max-Age: 3600`,
    },
    {
      title: "Caching preflight for 1 day",
      description: "The browser can cache the preflight response for 86400 seconds (1 day), significantly improving performance for frequently accessed resources.",
      code: `Access-Control-Max-Age: 86400`,
    },
  ],
  errors: [
    {
      msg: "Preflight requests still being sent for every request despite setting this header",
      fix: "Ensure the header is sent in OPTIONS responses, not actual requests. Check that your value doesn't exceed browser limits (7200 for Chrome, 86400 for Firefox). Verify identical requests are being made and check the Network tab to confirm the header is present in OPTIONS responses.",
    },
  ],
  faq: [
    {
      q: "What is the maximum value I can have for Access-Control-Max-Age?",
      a: "While the specification doesn't define a strict maximum, browsers impose their own limits. It's best to check current browser documentation for the most up-to-date limits.",
    },
  ],
};
---

<Layout
  title={`${headerData.name} | CORS Headers Explained`}
  description={headerData.description}
>
  <Article data={headerData} />
</Layout>
