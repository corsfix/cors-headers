---
import "../styles/global.css"; // Corrected path

export interface Props {
  title: string;
  description: string;
}

const { title, description } = Astro.props;

const canonical = new URL(Astro.site || "");
canonical.pathname = Astro.url.pathname.replace(/\.html$/, "");

// Get current path for active link highlighting
const currentPath = Astro.url.pathname;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    <link rel="canonical" href={canonical.toString()} />
    <script
      defer
      src="https://cloud.umami.is/script.js"
      data-website-id="df23c0f7-68fb-415c-91e7-5262eb2722a4"></script>
  </head>
  <body class="bg-[#fafafa]">
    <!-- Grid Layout -->
    <div class="grid lg:grid-cols-[256px_1fr] lg:grid-rows-[auto_1fr] h-screen">
      <!-- Logo Header (Row 1, Col 1) -->
      <div
        id="logo-header"
        class="bg-white border-b border-gray-200 border-r p-4 flex items-center fixed lg:sticky lg:top-0 w-64 lg:w-auto z-40 transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out"
      >
        <a href="/" class="block">
          <div class="flex justify-start items-center grow basis-0">
            <div class="mr-2 text-6xl">
              <img
                src="/cors-headers/logo.png"
                alt="Corsfix"
                class="size-10"
              />
            </div>
            <div class="font-semibold text-lg">Corsfix</div>
          </div>
        </a>
      </div>

      <!-- Title Header (Row 1, Col 2) -->
      <div
        class="bg-white border-b border-gray-200 p-4 flex items-center gap-4 sticky top-0 z-30"
      >
        <!-- Mobile Toggle Button -->
        <button
          id="sidebar-toggle"
          class="lg:hidden bg-white border border-gray-300 rounded p-2 hover:bg-gray-50"
          aria-label="Toggle sidebar"
        >
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
        <div class="text-lg font-medium text-gray-900">CORS Headers Explained</div>
      </div>

      <!-- Sidebar (Row 2, Col 1) -->
      <aside
        id="sidebar"
        class="bg-white border-r border-gray-200 overflow-y-auto flex flex-col fixed lg:static top-[65px] lg:top-auto bottom-0 lg:bottom-auto w-64 lg:w-auto z-40 transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out lg:h-full"
      >
        <!-- Navigation Links -->
        <nav class="flex-1 p-4 space-y-0.5">
          <a
            href="/cors-headers"
            class:list={[
              "block px-3 py-2 text-sm rounded-md transition-colors",
              currentPath === "/cors-headers" ||
              currentPath === "/cors-headers/"
                ? "bg-gray-100 text-gray-900 font-medium"
                : "text-gray-600 hover:bg-gray-50 hover:text-gray-900",
            ]}
          >
            CORS Headers
          </a>
          <a
            href="/cors-headers/access-control-allow-origin"
            class:list={[
              "block px-3 py-2 text-sm rounded-md transition-colors",
              currentPath === "/cors-headers/access-control-allow-origin" ||
              currentPath === "/cors-headers/access-control-allow-origin/"
                ? "bg-gray-100 text-gray-900 font-medium"
                : "text-gray-600 hover:bg-gray-50 hover:text-gray-900",
            ]}
          >
            Access-Control-Allow-Origin
          </a>
          <a
            href="/cors-headers/access-control-allow-credentials"
            class:list={[
              "block px-3 py-2 text-sm rounded-md transition-colors",
              currentPath ===
                "/cors-headers/access-control-allow-credentials" ||
              currentPath === "/cors-headers/access-control-allow-credentials/"
                ? "bg-gray-100 text-gray-900 font-medium"
                : "text-gray-600 hover:bg-gray-50 hover:text-gray-900",
            ]}
          >
            Access-Control-Allow-Credentials
          </a>
          <a
            href="/cors-headers/access-control-allow-headers"
            class:list={[
              "block px-3 py-2 text-sm rounded-md transition-colors",
              currentPath === "/cors-headers/access-control-allow-headers" ||
              currentPath === "/cors-headers/access-control-allow-headers/"
                ? "bg-gray-100 text-gray-900 font-medium"
                : "text-gray-600 hover:bg-gray-50 hover:text-gray-900",
            ]}
          >
            Access-Control-Allow-Headers
          </a>
          <a
            href="/cors-headers/access-control-allow-methods"
            class:list={[
              "block px-3 py-2 text-sm rounded-md transition-colors",
              currentPath === "/cors-headers/access-control-allow-methods" ||
              currentPath === "/cors-headers/access-control-allow-methods/"
                ? "bg-gray-100 text-gray-900 font-medium"
                : "text-gray-600 hover:bg-gray-50 hover:text-gray-900",
            ]}
          >
            Access-Control-Allow-Methods
          </a>
          <a
            href="/cors-headers/access-control-expose-headers"
            class:list={[
              "block px-3 py-2 text-sm rounded-md transition-colors",
              currentPath === "/cors-headers/access-control-expose-headers" ||
              currentPath === "/cors-headers/access-control-expose-headers/"
                ? "bg-gray-100 text-gray-900 font-medium"
                : "text-gray-600 hover:bg-gray-50 hover:text-gray-900",
            ]}
          >
            Access-Control-Expose-Headers
          </a>
          <a
            href="/cors-headers/access-control-max-age"
            class:list={[
              "block px-3 py-2 text-sm rounded-md transition-colors",
              currentPath === "/cors-headers/access-control-max-age" ||
              currentPath === "/cors-headers/access-control-max-age/"
                ? "bg-gray-100 text-gray-900 font-medium"
                : "text-gray-600 hover:bg-gray-50 hover:text-gray-900",
            ]}
          >
            Access-Control-Max-Age
          </a>
          <a
            href="/cors-headers/access-control-request-headers"
            class:list={[
              "block px-3 py-2 text-sm rounded-md transition-colors",
              currentPath === "/cors-headers/access-control-request-headers" ||
              currentPath === "/cors-headers/access-control-request-headers/"
                ? "bg-gray-100 text-gray-900 font-medium"
                : "text-gray-600 hover:bg-gray-50 hover:text-gray-900",
            ]}
          >
            Access-Control-Request-Headers
          </a>
          <a
            href="/cors-headers/access-control-request-method"
            class:list={[
              "block px-3 py-2 text-sm rounded-md transition-colors",
              currentPath === "/cors-headers/access-control-request-method" ||
              currentPath === "/cors-headers/access-control-request-method/"
                ? "bg-gray-100 text-gray-900 font-medium"
                : "text-gray-600 hover:bg-gray-50 hover:text-gray-900",
            ]}
          >
            Access-Control-Request-Method
          </a>
          <a
            href="/cors-headers/origin"
            class:list={[
              "block px-3 py-2 text-sm rounded-md transition-colors",
              currentPath === "/cors-headers/origin" ||
              currentPath === "/cors-headers/origin/"
                ? "bg-gray-100 text-gray-900 font-medium"
                : "text-gray-600 hover:bg-gray-50 hover:text-gray-900",
            ]}
          >
            Origin
          </a>
        </nav>

        <!-- Footer -->
        <div
          class="p-4 border-t border-gray-200 text-xs text-gray-500 space-y-1"
        >
          <p class="font-medium">CORS Headers Explained by Corsfix</p>
          <p>Content licensed under CC-BY-SA-4.0</p>
        </div>
      </aside>

      <!-- Main Content (Row 2, Col 2) -->
      <main class="bg-[#fafafa] overflow-auto">
        <slot />
      </main>
    </div>

    <!-- Overlay for mobile -->
    <div id="sidebar-overlay" class="fixed inset-0 z-30 hidden lg:hidden"></div>

    <script>
      const sidebar = document.getElementById("sidebar");
      const logoHeader = document.getElementById("logo-header");
      const toggle = document.getElementById("sidebar-toggle");
      const overlay = document.getElementById("sidebar-overlay");

      function toggleSidebar() {
        sidebar?.classList.toggle("-translate-x-full");
        logoHeader?.classList.toggle("-translate-x-full");
        overlay?.classList.toggle("hidden");
      }

      toggle?.addEventListener("click", toggleSidebar);
      overlay?.addEventListener("click", toggleSidebar);
    </script>
  </body>
</html>
